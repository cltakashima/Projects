Data Scientist Role Play: Profiling and Analyzing the Yelp Dataset Coursera Worksheet

This is a 2-part assignment. In the first part, you are asked a series of questions that will help you profile and understand the data just like a data scientist would. For this first part of the assignment, you will be assessed both on the correctness of your findings, as well as the code you used to arrive at your answer. You will be graded on how easy your code is to read, so remember to use proper formatting and comments where necessary.

In the second part of the assignment, you are asked to come up with your own inferences and analysis of the data for a particular research question you want to answer. You will be required to prepare the dataset for the analysis you choose to do. As with the first part, you will be graded, in part, on how easy your code is to read, so use proper formatting and comments to illustrate and communicate your intent as required.

For both parts of this assignment, use this "worksheet." It provides all the questions you are being asked, and your job will be to transfer your answers and SQL coding where indicated into this worksheet so that your peers can review your work. You should be able to use any Text Editor (Windows Notepad, Apple TextEdit, Notepad ++, Sublime Text, etc.) to copy and paste your answers. If you are going to use Word or some other page layout application, just be careful to make sure your answers and code are lined appropriately.
In this case, you may want to save as a PDF to ensure your formatting remains intact for you reviewer.



Part 1: Yelp Dataset Profiling and Understanding

1. Profile the data by finding the total number of records for each of the tables below:
	
i. Attribute table = 10000

SELECT COUNT(*) AS TotalRecords
FROM attribute

ii. Business table = 10000

SELECT COUNT(*) AS TotalRecords
FROM business

iii. Category table = 10000

SELECT COUNT(*) AS TotalRecords
FROM category

iv. Checkin table = 10000

SELECT COUNT(*) AS TotalRecords
FROM checkin

v. elite_years table = 10000

SELECT COUNT(*) AS TotalRecords
FROM elite_years

vi. friend table = 10000

SELECT COUNT(*) AS TotalRecords
FROM friend

vii. hours table = 10000

SELECT COUNT(*) AS TotalRecords
FROM hours

viii. photo table = 10000

SELECT COUNT(*) AS TotalRecords
FROM photo

ix. review table = 10000

SELECT COUNT(*) AS TotalRecords
FROM review

x. tip table = 10000

SELECT COUNT(*) AS TotalRecords
FROM tip

xi. user table = 10000

SELECT COUNT(*) AS TotalRecords
FROM user
	

2. Find the total distinct records by either the foreign key or primary key for each table. If two foreign keys are listed in the table, please specify which foreign key.

i. Business = 

-- Primary Key: id = 10000

SELECT COUNT(DISTINCT id)
FROM business

ii. Hours =

-- Foreign Key: business_id = 1562

SELECT COUNT(DISTINCT business_id)
FROM hours

iii. Category = 

-- Foreign Key: business_id = 2643

SELECT COUNT(DISTINCT business_id)
FROM hours

iv. Attribute = 

-- Foreign Key: business_id = 1115

SELECT COUNT(DISTINCT business_id)
FROM attribute

v. Review = 

-- Primary Key: id = 10000

SELECT  COUNT(DISTINCT id)
FROM review

-- Foreign Key(1): business_id = 8090

SELECT  COUNT(DISTINCT business_id)
FROM review

-- Foreign Key(2): user_id = 9581

SELECT  COUNT(DISTINCT user_id)
FROM review

vi. Checkin = 

-- Foreign Key: business_id = 493

SELECT  COUNT(DISTINCT business_id)
FROM checkin

vii. Photo = 

-- Primary Key: id = 10000

SELECT  COUNT(DISTINCT id)
FROM photo

-- Foreign Key: business_id = 6493

SELECT  COUNT(DISTINCT business_id)
FROM photo

viii. Tip = 

-- Foreign Key(1): user_id = 537

SELECT  COUNT(DISTINCT user_id)
FROM tip

-- Foreign Key(2): business_id = 3979

SELECT  COUNT(DISTINCT business_id)
FROM tip

ix. User =

-- Primary Key: id = 10000

SELECT  COUNT(DISTINCT id)
FROM user

x. Friend = 

-- Foreign Key: user_id = 11

SELECT  COUNT(DISTINCT user_id)
FROM friend

xi. Elite_years =

-- Foreign Key: user_id = 2780

SELECT COUNT(DISTINCT user_id)
FROM elite_years

Note: Primary Keys are denoted in the ER-Diagram with a yellow key icon.	



3. Are there any columns with null values in the Users table? Indicate "yes," or "no."

	Answer: No
	
	
	SQL code used to arrive at answer:
	
	SELECT 
    name
FROM 
    user
WHERE 
    id IS NULL OR
    name IS NULL OR
    review_count IS NULL OR
    yelping_since IS NULL OR
    useful IS NULL OR
    funny IS NULL OR
    cool IS NULL OR
    fans IS NULL OR
    average_stars IS NULL OR
    compliment_hot IS NULL OR
    compliment_more IS NULL OR
    compliment_profile IS NULL OR
    compliment_cute IS NULL OR
    compliment_list IS NULL OR
    compliment_note IS NULL OR
    compliment_plain IS NULL OR
    compliment_cool IS NULL OR
    compliment_funny IS NULL OR
    compliment_writer IS NULL OR
    compliment_photos IS NULL
	

	
4. For each table and column listed below, display the smallest (minimum), largest (maximum), and average (mean) value for the following fields:

	i. Table: Review, Column: Stars
	
		min: 1		max: 5		avg: 3.7082 (Rounded: 4)
		
	
	ii. Table: Business, Column: Stars
	
		min: 1.0	max: 5.0	avg: 3.6549
		
	
	iii. Table: Tip, Column: Likes
	
		min: 0		max: 2		avg: 0.0144
		
	
	iv. Table: Checkin, Column: Count
	
		min: 1		max: 53	 	avg: 1.94 (Rounded: 2)
		
	
	v. Table: User, Column: Review_count
	
		min: 0		max: 2000		avg: 24.2995
		


5. List the cities with the most reviews in descending order:

	SQL code used to arrive at answer: 
	
SELECT DISTINCT(business.city), COUNT(review.id) AS MostReviews
FROM business JOIN review ON
    business.id = review.business_id
GROUP BY business.city
ORDER BY MostReviews DESC, business.city

	Copy and Paste the Result Below:
	
+-----------------+-------------+
| city            | MostReviews |
+-----------------+-------------+
| Las Vegas       |         193 |
| Phoenix         |          65 |
| Toronto         |          51 |
| Scottsdale      |          37 |
| Henderson       |          30 |
| Tempe           |          28 |
| Pittsburgh      |          23 |
| Chandler        |          22 |
| Charlotte       |          21 |
| Montréal        |          18 |
| Madison         |          16 |
| Gilbert         |          13 |
| Mesa            |          13 |
| Cleveland       |          12 |
| North Las Vegas |           6 |
| Edinburgh       |           5 |
| Glendale        |           5 |
| Lakewood        |           5 |
| Cave Creek      |           4 |
| Champaign       |           4 |
| Markham         |           4 |
| North York      |           4 |
| Mississauga     |           3 |
| Surprise        |           3 |
| Avondale        |           2 |
+-----------------+-------------+
(Output limit exceeded, 25 of 67 total rows shown)
	
6. Find the distribution of star ratings to the business in the following cities:

i. Avon

SQL code used to arrive at answer:

SELECT
    star_rating,
    count
FROM 
    (SELECT 
        DISTINCT(business.city),
        review.stars AS star_rating,
        COUNT(review.stars) AS count
    FROM 
        business JOIN review ON
        business.id = review.business_id
    WHERE
        city LIKE "Avo%"
    GROUP BY 
        business.city, review.stars)
ORDER BY 
    star_rating DESC

Copy and Paste the Resulting Table Below (2 columns – star rating and count):

+-------------+-------+
| star_rating | count |
+-------------+-------+
|           5 |     1 |
|           2 |     1 |
+-------------+-------+


ii. Beachwood

SQL code used to arrive at answer:

SELECT
    star_rating,
    count
FROM 
    (SELECT 
        DISTINCT(business.city),
        review.stars AS star_rating,
        COUNT(review.stars) AS count
    FROM 
        business JOIN review ON
        business.id = review.business_id
    WHERE
        city LIKE "Beach%"
    GROUP BY 
        business.city, review.stars)
ORDER BY 
    star_rating DESC

Copy and Paste the Resulting Table Below (2 columns – star rating and count):
		
+-------------+-------+
| star_rating | count |
+-------------+-------+
|           3 |     1 |
+-------------+-------+

7. Find the top 3 users based on their total number of reviews:
		
	SQL code used to arrive at answer:
	
SELECT id, name, review_count
FROM user
ORDER BY review_count DESC
LIMIT 3
		
	Copy and Paste the Result Below:
		
+------------------------+--------+--------------+
| id                     | name   | review_count |
+------------------------+--------+--------------+
| -G7Zkl1wIWBBmD0KRy_sCw | Gerald |         2000 |
| -3s52C4zL_DHRK0ULG6qtg | Sara   |         1629 |
| -8lbUNlXVSoXqaRRiHiSNg | Yuri   |         1339 |
+------------------------+--------+--------------+

8. Does posing more reviews correlate with more fans?

	Please explain your findings and interpretation of the results:
	
It appears that more reviews correlates with more fans to some extent.  Although it may lead to more fans due to more exposure, having more reviews doesn't necessarly correlate mean one user will have the most fans.  The data shows that people with more reviews have more fans, but some of the most active users don't have the highest number of followers, which can be interpreted in several ways:

		(a) Perhaps the quality of the review(s); Some users may write very brief and little actual detail about a location compared to other users that may have less reviews, but very detailed.

		(b) The quality of the writing may affect how many fans a user may have.  Some user may have easy and quality reviews versus poorly written and basic reviews.

		(c) Biased opinions:  If a user has a biased perspective, too hihgly critical, or not critical enough, it may affect the number of fans a user may have

		(d) Number & Quality of locations: Some users may have more fans due to the variety and quality of restaurants/locations they review. This may serve as inspiration for fans to follow, and as such influence more people that will become fans.

SELECT id, name, review_count, fans
FROM user
ORDER BY review_count DESC
LIMIT 10

+------------------------+-----------+--------------+------+
| id                     | name      | review_count | fans |
+------------------------+-----------+--------------+------+
| -G7Zkl1wIWBBmD0KRy_sCw | Gerald    |         2000 |  253 |
| -3s52C4zL_DHRK0ULG6qtg | Sara      |         1629 |   50 |
| -8lbUNlXVSoXqaRRiHiSNg | Yuri      |         1339 |   76 |
| -K2Tcgh2EKX6e6HqqIrBIQ | .Hon      |         1246 |  101 |
| -FZBTkAZEXoP7CYvRV2ZwQ | William   |         1215 |  126 |
| --2vR0DIsmQ6WfcSzKWigw | Harald    |         1153 |  311 |
| -gokwePdbXjfS0iF7NsUGA | eric      |         1116 |   16 | <- Good example of many reviews & low fans
| -DFCC64NXgqrxlO8aLU5rg | Roanna    |         1039 |  104 |
| -8EnCioUmDygAbsYZmTeRQ | Mimi      |          968 |  497 |
| -0IiMAZI2SsQ7VmyzJjokQ | Christine |          930 |  173 |
+------------------------+-----------+--------------+------+

SELECT id, name, review_count, fans
FROM user
ORDER BY review_count
LIMIT 10

+------------------------+---------------+--------------+------+
| id                     | name          | review_count | fans |
+------------------------+---------------+--------------+------+
| -61V4ZkRsKUChYFZtdZDvQ | Sonnenschein1 |            0 |    0 |
| -9TyYbKtEz-pxeZyLICOgA | svenher       |            0 |    0 |
| -arJ-0bq2eycINnHrm0LFA | Schweinefe    |            0 |    0 |
| -d8nnc-pp6qj_6qnp4IN-g | Luke          |            0 |    0 |
| -Dhxu5B36bkm65ciME0vxg | Limon-Du      |            0 |    0 |
| -G0sArycZyO_-AHlCPI4IQ | ab            |            0 |    0 |
| -hQK8Yu-Be8tZu-5K3j6RA | torstenbec    |            0 |    0 |
| -lfArh6lSfDddoa-KP5ZPQ | snek          |            0 |    0 |
| -lyoqQ69K6RWsZHstAoQ1A |               |            0 |    0 |
| --0sXNBv6IizZXuV-nl0Aw | Joe           |            1 |    0 | <- Low Reviews, No Fans
+------------------------+---------------+--------------+------+

SELECT id, name, review_count, fans
FROM user
WHERE fans BETWEEN 10 AND 200
ORDER BY review_count DESC

+------------------------+-----------+--------------+------+
| id                     | name      | review_count | fans |
+------------------------+-----------+--------------+------+
| -3s52C4zL_DHRK0ULG6qtg | Sara      |         1629 |   50 |
| -8lbUNlXVSoXqaRRiHiSNg | Yuri      |         1339 |   76 |
| -K2Tcgh2EKX6e6HqqIrBIQ | .Hon      |         1246 |  101 |
| -FZBTkAZEXoP7CYvRV2ZwQ | William   |         1215 |  126 |
| -gokwePdbXjfS0iF7NsUGA | eric      |         1116 |   16 |<- Many reviews, Low fans
| -DFCC64NXgqrxlO8aLU5rg | Roanna    |         1039 |  104 |
| -0IiMAZI2SsQ7VmyzJjokQ | Christine |          930 |  173 |
| -fUARDNuXAfrOn4WLSZLgA | Ed        |          904 |   38 |
| -hKniZN2OdshWLHYuj21jQ | Nicole    |          864 |   43 |
| -9da1xk7zgnnfO1uTVYGkA | Fran      |          862 |  124 |
| -B-QEUESGWHPE_889WJaeg | Mark      |          861 |  115 |
| -kLVfaJytOJY2-QdQoCcNQ | Christina |          842 |   85 |
| -kO6984fXByyZm3_6z2JYg | Dominic   |          836 |   37 |
| -lh59ko3dxChBSZ9U7LfUw | Lissa     |          834 |  120 |
| -g3XIcCb2b-BD0QBCcq2Sw | Lisa      |          813 |  159 |
| -l9giG8TSDBG1jnUBUXp5w | Alison    |          775 |   61 |
| -dw8f7FLaUmWR7bfJ_Yf0w | Sui       |          754 |   78 |
| -AaBjWJYiQxXkCMDlXfPGw | Tim       |          702 |   35 |
| -jt1ACMiZljnBFvS6RRvnA | L         |          696 |   10 |
| -IgKkE8JvYNWeGu8ze4P8Q | Angela    |          694 |  101 |<- Less reviews, but more fans than above
| -hxUwfo3cMnLTv-CAaP69A | Crissy    |          676 |   25 |
| -H6cTbVxeIRYR-atxdielQ | Lyn       |          675 |   45 |
| -0SqALqeWmInVftG_iHcHg | Jim       |          671 |   57 |
| -gCbrwbpIn3jTEsAbtIFBQ | Grace     |          663 |   30 |
| -HXpF9E-YwE0g-mInWSRuA | Jenn      |          657 |   62 |
+------------------------+-----------+--------------+------+
9. Are there more reviews with the word "love" or with the word "hate" in them?

	Answer: love

	
	SQL code used to arrive at answer:

SELECT 
    'Love' AS Feeling, 
    COUNT(*) AS Count
FROM 
    review
WHERE 
    text LIKE "%love%"

UNION

SELECT 
    'Hate' AS Feeling, 
    COUNT(*) AS Count
FROM 
    review
WHERE 
    text LIKE "%hate%"
ORDER BY 
    Count DESC

+---------+-------+
| Feeling | Count |
+---------+-------+
| Love    |  1780 |
| Hate    |   232 |
+---------+-------+

10. Find the top 10 users with the most fans:

	SQL code used to arrive at answer:
	
SSELECT
    name,
    fans,
    review_count
FROM
    user
ORDER BY 
    fans DESC, 
    review_count
LIMIT
    10

	Copy and Paste the Result Below:

+-----------+------+--------------+
| name      | fans | review_count |
+-----------+------+--------------+
| Amy       |  503 |          609 |
| Mimi      |  497 |          968 |
| Harald    |  311 |         1153 |
| Gerald    |  253 |         2000 |
| Christine |  173 |          930 |
| Lisa      |  159 |          813 |
| Cat       |  133 |          377 |
| William   |  126 |         1215 |
| Fran      |  124 |          862 |
| Lissa     |  120 |          834 |
+-----------+------+--------------+
		

Part 2: Inferences and Analysis

1. Pick one city and category of your choice and group the businesses in that city or category by their overall star rating. Compare the businesses with 2-3 stars to the businesses with 4-5 stars and answer the following questions. Include your code.
	
i. Do the two groups you chose to analyze have a different distribution of hours?

-- There are several ways to go about this since the "Hours" column includes several days per week including times.  As such I chose to base my answer on the following query and found that the two groups have a difference in distribution hours daily, and with the number of days of operation per week. * I limited to 15 to avoid taking up too much space

SELECT
    b.name,
    b.city, 
    b.stars,
    b.review_count,
    COUNT(h.hours) AS Days_Open
FROM
    business b JOIN hours h ON 
    b.id = h.business_id
GROUP BY  
    b.name, b.city, b.stars, b.review_count
ORDER BY 
    Days_Open DESC
LIMIT
    15

+----------------------------------------+-----------+-------+--------------+-----------+
| name                                   | city      | stars | review_count | Days_Open |
+----------------------------------------+-----------+-------+--------------+-----------+
| 99 Cent Sushi                          | Toronto   |   2.0 |            5 |         7 | <- Days open, doesn't
| Apache Wash Trailhead                  | Phoenix   |   5.0 |            9 |         7 |    correlate to stars
| B.A. Sweetie Candy                     | Cleveland |   4.0 |           49 |         7 |
| Big Smoke Burger                       | Toronto   |   3.0 |           47 |         7 |
| Big Wong Restaurant                    | Las Vegas |   4.0 |          768 |         7 |
| Bobs Smoke Shop                        | Tempe     |   3.5 |            3 |         7 |
| Bootleggers Modern American Smokehouse | Phoenix   |   4.0 |          431 |         7 |
| Brubaker's Pub                         | Hudson    |   3.0 |            5 |         7 |
| C's Restaurant Bakery and Coffee Shop  | Middleton |   4.0 |           37 |         7 |
| Cabin Fever                            | Toronto   |   4.5 |           26 |         7 |
| Camden Fairview                        | Charlotte |   5.0 |            6 |         7 |<- If we compare, the rating
| Cash Time Loan Center                  | Mesa      |   3.0 |            4 |         7 |   is completely different
| Charlie D's Catfish & Chicken          | Phoenix   |   4.5 |            7 |         7 |   despite similar days of
| Clean Colonic                          | Tempe     |   5.0 |            5 |         7 |   operation
| Clean Machine                          | Cleveland |   4.5 |            3 |         7 |
+----------------------------------------+-----------+-------+--------------+-----------+

SELECT
    b.name,
    b.city, 
    b.stars,
    b.review_count,
    COUNT(h.hours) AS Days_Open
FROM
    business b JOIN hours h ON 
    b.id = h.business_id
GROUP BY  
    b.name, b.city, b.stars, b.review_count
ORDER BY 
    Days_Open
LIMIT
    15

-- Same Query, just ORDER BY Days_Open ASC
+-------------------------------+------------+-------+--------------+-----------+
| name                          | city       | stars | review_count | Days_Open |
+-------------------------------+------------+-------+--------------+-----------+
| Good Gosh Beauty              | Toronto    |   4.5 |            6 |         3 |<- Star rating is high despite open
| Ahn & Perez, DDS              | Tempe      |   4.5 |           13 |         4 |   3 days per week
| Children's Dental Center      | Las Vegas  |   4.0 |           11 |         4 |
| Haggard Chiropractic          | Phoenix    |   5.0 |           18 |         4 |
| Mood                          | Edinburgh  |   2.0 |           11 |         4 |
| AAA Phoenix Office            | Phoenix    |   3.5 |           80 |         5 |
| Adobe Montessori              | Chandler   |   5.0 |            5 |         5 |
| Baby Cakes                    | Willoughby |   3.5 |            5 |         5 |<- lower star ratingn despite 5 open
| Back-Health Chiropractic      | Phoenix    |   5.0 |           19 |         5 |   5 days per week
| Cardiac Solutions             | Peoria     |   3.0 |            9 |         5 |
| Christian Brothers Automotive | Chandler   |   5.0 |           63 |         5 |
| Desert Medical Equipment      | Las Vegas  |   5.0 |            4 |         5 |
| Dilworth Custom Framing       | Charlotte  |   3.5 |            6 |         5 |
| Edulis                        | Toronto    |   4.0 |           89 |         5 |
| Innercity MMA                 | Toronto    |   5.0 |            3 |         5 |
+-------------------------------+------------+-------+--------------+-----------+

-- Some businesses have higher ratings, but are open less days and less hours versus others are open many days and hours, but still have low ratings, and vice-versa. There's no particular pattern. 



ii. Do the two groups you chose to analyze have a different number of reviews?
         
-- On Average, there does seem to be a higher correlation between number of reviews and stars, than by hours of operation. 

SELECT
    b.name,
    b.city, 
    b.stars,
    b.review_count,
    COUNT(h.hours) AS Days_Open
FROM
    business b JOIN hours h ON 
    b.id = h.business_id
GROUP BY  
    b.name, b.city, b.stars, b.review_count
ORDER BY 
    stars
LIMIT
    15

 +-------------------------------------+-----------------+-------+--------------+-----------+
| name                                | city            | stars | review_count | Days_Open |
+-------------------------------------+-----------------+-------+--------------+-----------+
| Fresh Bonsai Nails & Spa            | Richmond Hill   |   1.5 |            7 |         7 |<- Review count is low 
| Holiday Inn Express Oakwood Village | Oakwood Village |   1.5 |            9 |         7 |   for low star ratings
| 99 Cent Sushi                       | Toronto         |   2.0 |            5 |         7 |
| Ghost Armor SS Springs              | Mesa            |   2.0 |            3 |         7 |
| McDonald's                          | Phoenix         |   2.0 |            8 |         7 |
| Mood                                | Edinburgh       |   2.0 |           11 |         4 |
| T-Mobile                            | Gilbert         |   2.0 |            4 |         7 |
| Loblaws                             | Toronto         |   2.5 |           10 |         7 |
| Papa Da Vinci                       | Pittsburgh      |   2.5 |           28 |         7 |
| Snip-its Rocky River                | Rocky River     |   2.5 |           18 |         7 |
| The Fox & Fiddle                    | Toronto         |   2.5 |           35 |         7 |
| Walgreens                           | Las Vegas       |   2.5 |            6 |         7 |
| Big Smoke Burger                    | Toronto         |   3.0 |           47 |         7 |
| Brubaker's Pub                      | Hudson          |   3.0 |            5 |         7 |
| Cardiac Solutions                   | Peoria          |   3.0 |            9 |         5 |
+-------------------------------------+-----------------+-------+--------------+-----------+

-- If we change the query to review_count DESC, you can see that more stars correlates to higher review_count

SELECT
    b.name,
    b.city, 
    b.stars,
    b.review_count,
    COUNT(h.hours) AS Days_Open
FROM
    business b JOIN hours h ON 
    b.id = h.business_id
GROUP BY  
    b.name, b.city, b.stars, b.review_count
ORDER BY 
    review_count DESC
LIMIT
    15

 +----------------------------------------+------------+-------+--------------+-----------+
| name                                   | city       | stars | review_count | Days_Open |
+----------------------------------------+------------+-------+--------------+-----------+
| Big Wong Restaurant                    | Las Vegas  |   4.0 |          768 |         7 |<- Mostly above 4 Stars
| West Side Market                       | Cleveland  |   4.5 |          723 |         5 |
| Bootleggers Modern American Smokehouse | Phoenix    |   4.0 |          431 |         7 |
| Slyman's Restaurant                    | Cleveland  |   4.5 |          361 |         6 |
| Green Corner Restaurant                | Mesa       |   5.0 |          267 |         7 |
| Taliesin West                          | Scottsdale |   4.5 |          223 |         7 |
| Jacques Cafe                           | Las Vegas  |   4.0 |          168 |         7 |
| Koko Bakery                            | Cleveland  |   4.0 |          162 |         6 |
| Irish Republic                         | Chandler   |   3.0 |          141 |         7 |
| Eklectic Pie - Mesa                    | Mesa       |   4.0 |          129 |         7 |
| Wingstop                               | Las Vegas  |   3.0 |          123 |         7 |
| Hi Scores - Blue Diamond               | Las Vegas  |   3.5 |          105 |         7 |
| Mad Mex - South Hills                  | Pittsburgh |   3.0 |          103 |         7 |
| The Cider Mill                         | Scottsdale |   4.0 |           91 |         7 |
| Edulis                                 | Toronto    |   4.0 |           89 |         5 |
+----------------------------------------+------------+-------+--------------+-----------+

SELECT
    b.name,
    b.city, 
    b.stars,
    b.review_count,
    COUNT(h.hours) AS Days_Open
FROM
    business b JOIN hours h ON 
    b.id = h.business_id
GROUP BY  
    b.name, b.city, b.review_count
ORDER BY 
    review_count
LIMIT
	15

+------------------------------------+---------------+-------+--------------+-----------+
| name                               | city          | stars | review_count | Days_Open |
+------------------------------------+---------------+-------+--------------+-----------+
| All Storage - Anthem               | Henderson     |   3.5 |            3 |         6 |<- More variety of star
| Alterations Express                | Strongsville  |   4.0 |            3 |         6 |   ratings below 4 when
| Bobs Smoke Shop                    | Tempe         |   3.5 |            3 |         7 |	less review_count
| Clean Machine                      | Cleveland     |   4.5 |            3 |         7 |
| Ghost Armor SS Springs             | Mesa          |   2.0 |            3 |         7 |
| Innercity MMA                      | Toronto       |   5.0 |            3 |         5 |
| Journey's Dry Carpet Cleaning      | Charlotte     |   5.0 |            3 |         7 |
| Kelsey's Pet Sitting & Dog Walking | Surprise      |   5.0 |            3 |         7 |
| Oinky's Pork Chop Heaven           | North Randall |   3.0 |            3 |         7 |
| P & J Hamburgers Inn               | Mississauga   |   3.0 |            3 |         6 |
| Big City Grill                     | Charlotte     |   5.0 |            4 |         6 |
| Buddy's Muffler & Exhaust          | Gastonia      |   5.0 |            4 |         6 |
| Cash Time Loan Center              | Mesa          |   3.0 |            4 |         7 |
| Desert Medical Equipment           | Las Vegas     |   5.0 |            4 |         5 |
| Dollar Mania                       | Chandler      |   5.0 |            4 |         7 |
+------------------------------------+---------------+-------+--------------+-----------+

iii. Are you able to infer anything from the location data provided between these two groups? Explain.

I added state to my query and noticed that more stars seem to go to places with lower latitudes, warmer locations.  When I change the ORDER By stars to DESC one can see in the state results that it includes certain locations more than others based on the extreme bottom to top

SQL code used for analysis:

SELECT
    b.name,
    b.city, 
    b.state,
    b.stars,
    b.review_count,
    COUNT(h.hours) AS Days_Open
FROM
    business b JOIN hours h ON 
    b.id = h.business_id
GROUP BY  
    b.name, b.city, b.review_count
ORDER BY 
    stars DESC                                          
                                           
                                                        
+--------------------------------------+------------+-------+-------+--------------+-----------+
| name                                 | city       | state | stars | review_count | Days_Open |<- 	States with
+--------------------------------------+------------+-------+-------+--------------+-----------+	high star ratings
| Adobe Montessori                     | Chandler   | AZ    |   5.0 |            5 |         5 |	are in AZ,NV,NC
| Apache Wash Trailhead                | Phoenix    | AZ    |   5.0 |            9 |         7 |	(lower latitudes)
| Back-Health Chiropractic             | Phoenix    | AZ    |   5.0 |           19 |         5 |
| Big City Grill                       | Charlotte  | NC    |   5.0 |            4 |         6 |
| Brandi Gilstrap                      | Henderson  | NV    |   5.0 |            5 |         6 |
| Buddy's Muffler & Exhaust            | Gastonia   | NC    |   5.0 |            4 |         6 |
| Camden Fairview                      | Charlotte  | NC    |   5.0 |            6 |         7 |
| Christian Brothers Automotive        | Chandler   | AZ    |   5.0 |           63 |         5 |
| Clean Colonic                        | Tempe      | AZ    |   5.0 |            5 |         7 |
| Desert Medical Equipment             | Las Vegas  | NV    |   5.0 |            4 |         5 |
| Dollar Mania                         | Chandler   | AZ    |   5.0 |            4 |         7 |
| Green Corner Restaurant              | Mesa       | AZ    |   5.0 |          267 |         7 |
| Haggard Chiropractic                 | Phoenix    | AZ    |   5.0 |           18 |         4 |
| Innercity MMA                        | Toronto    | ON    |   5.0 |            3 |         5 |
| Journey's Dry Carpet Cleaning        | Charlotte  | NC    |   5.0 |            3 |         7 |
| Kelsey's Pet Sitting & Dog Walking   | Surprise   | AZ    |   5.0 |            3 |         7 |
| Lifestyles Fitness Personal Training | Tempe      | AZ    |   5.0 |           17 |         6 |
| Motors & More                        | Las Vegas  | NV    |   5.0 |            7 |         6 |
| PC Savants                           | Sun City   | AZ    |   5.0 |           11 |         7 |
| PRO BIKE+RUN                         | Pittsburgh | PA    |   5.0 |            8 |         7 |
| Race Day Mobile Detailing            | Phoenix    | AZ    |   5.0 |           40 |         7 |
| Red Apron Bakeshop                   | Chandler   | AZ    |   5.0 |            5 |         7 |
| Springmaster Garage Door Service     | Chandler   | AZ    |   5.0 |            7 |         7 |
| Ahn & Perez, DDS                     | Tempe      | AZ    |   4.5 |           13 |         4 |
| Cabin Fever                          | Toronto    | ON    |   4.5 |           26 |         7 |
+--------------------------------------+------------+-------+-------+--------------+-----------+

-- If we ORDER BY stars ASC it you can see locations in higher latitudes or colder locations

SELECT
    b.name,
    b.city, 
    b.state,
    b.stars,
    b.review_count,
    COUNT(h.hours) AS Days_Open
FROM
    business b JOIN hours h ON 
    b.id = h.business_id
GROUP BY  
    b.name, b.city, b.review_count
ORDER BY 
    stars

+-------------------------------------+-----------------+-------+-------+--------------+-----------+
| name                                | city            | state | stars | review_count | Days_Open |<- States with 
+-------------------------------------+-----------------+-------+-------+--------------+-----------+	lower stars
| Fresh Bonsai Nails & Spa            | Richmond Hill   | ON    |   1.5 |            7 |         7 |	appear in 
| Holiday Inn Express Oakwood Village | Oakwood Village | OH    |   1.5 |            9 |         7 |	higher
| 99 Cent Sushi                       | Toronto         | ON    |   2.0 |            5 |         7 |	latitudes
| Ghost Armor SS Springs              | Mesa            | AZ    |   2.0 |            3 |         7 |
| McDonald's                          | Phoenix         | AZ    |   2.0 |            8 |         7 |
| Mood                                | Edinburgh       | EDH   |   2.0 |           11 |         4 |
| T-Mobile                            | Gilbert         | AZ    |   2.0 |            4 |         7 |
| Loblaws                             | Toronto         | ON    |   2.5 |           10 |         7 |
| Papa Da Vinci                       | Pittsburgh      | PA    |   2.5 |           28 |         7 |
| Snip-its Rocky River                | Rocky River     | OH    |   2.5 |           18 |         7 |
| The Fox & Fiddle                    | Toronto         | ON    |   2.5 |           35 |         7 |
| Walgreens                           | Las Vegas       | NV    |   2.5 |            6 |         7 |
| Big Smoke Burger                    | Toronto         | ON    |   3.0 |           47 |         7 |
| Brubaker's Pub                      | Hudson          | OH    |   3.0 |            5 |         7 |
| Cardiac Solutions                   | Peoria          | AZ    |   3.0 |            9 |         5 |
| Cash Time Loan Center               | Mesa            | AZ    |   3.0 |            4 |         7 |
| Flaming Kitchen                     | Markham         | ON    |   3.0 |           25 |         7 |
| Gallagher's                         | Phoenix         | AZ    |   3.0 |           60 |         7 |
| Irish Republic                      | Chandler        | AZ    |   3.0 |          141 |         7 |
| Kb Home Studio                      | Phoenix         | AZ    |   3.0 |            5 |         7 |
| Mad Mex - South Hills               | Pittsburgh      | PA    |   3.0 |          103 |         7 |
| Oinky's Pork Chop Heaven            | North Randall   | OH    |   3.0 |            3 |         7 |
| Otto Onkel                          | Stuttgart       | BW    |   3.0 |           50 |         7 |
| P & J Hamburgers Inn                | Mississauga     | ON    |   3.0 |            3 |         6 |
| Pizzaiolo                           | Toronto         | ON    |   3.0 |           34 |         7 |
+-------------------------------------+-----------------+-------+-------+--------------+-----------+
(Output limit exceeded, 25 of 117 total rows shown)
		
2. Group business based on the ones that are open and the ones that are closed. What differences can you find between the ones that are still open and the ones that are closed? List at least two differences and the SQL code you used to arrive at your answer.
		
i. Difference 1: 
         
         -- Open Businesses tend to have higher number of reviews on AVG.
         
ii. Difference 2:
         
         -- Most obvious is that here are many more open businesses than closed.
         -- Most reviews seem to be from Places with major cities such as NV (Las Vegas, Henderson), AZ (Scottsdale, Phoenix,) and ON (Canada - Montreal)
         
SQL code used for analysis:

	SELECT
    state,
    CASE WHEN is_open = '1' THEN 'Open' ELSE 'Closed' END AS business_status,
    COUNT(name) AS total_businesses,
    ROUND(AVG(stars),2) AS avg_star_rating,
    ROUND(AVG(review_count),2) AS avg_review_count,
    MAX(review_count) AS MAX_Reviews,
    MIN(review_count) AS MIN_Reviews
FROM
    business
GROUP BY
    business_status, state
ORDER BY    
    business_status, total_businesses DESC

+-------+-----------------+------------------+-----------------+------------------+-------------+-------------+
| state | business_status | total_businesses | avg_star_rating | avg_review_count | MAX_Reviews | MIN_Reviews |
+-------+-----------------+------------------+-----------------+------------------+-------------+-------------+
| AZ    | Closed          |              452 |            3.53 |            25.08 |         700 |           3 |
| NV    | Closed          |              300 |            3.54 |            38.09 |         566 |           3 |
| ON    | Closed          |              281 |             3.4 |            18.49 |         201 |           3 |
| OH    | Closed          |              102 |            3.45 |            13.24 |         114 |           3 |
| NC    | Closed          |               96 |             3.6 |            22.02 |         165 |           3 |
| PA    | Closed          |               90 |             3.7 |             16.8 |         135 |           3 |
| QC    | Closed          |               69 |            3.47 |            12.06 |          78 |           3 |
| EDH   | Closed          |               51 |            3.67 |            10.78 |          49 |           3 |
| WI    | Closed          |               29 |            3.48 |            16.69 |          68 |           3 |
| BW    | Closed          |               21 |            3.62 |             7.76 |          33 |           3 |
| IL    | Closed          |               14 |            3.36 |            11.36 |          34 |           4 |
| SC    | Closed          |                8 |            3.81 |            11.75 |          29 |           3 |
| MLN   | Closed          |                3 |            4.17 |             9.67 |          20 |           4 |
| ELN   | Closed          |                2 |             4.0 |              3.0 |           3 |           3 |
| HLD   | Closed          |                1 |             3.0 |              3.0 |           3 |           3 |
| NI    | Closed          |                1 |             3.0 |              3.0 |           3 |           3 |
| AZ    | Open            |             2590 |            3.76 |            34.44 |        1549 |           3 |
| NV    | Open            |             1621 |            3.76 |            52.48 |        3873 |           3 |
| ON    | Open            |             1383 |            3.48 |            22.54 |         778 |           3 |
| OH    | Open            |              645 |             3.6 |            20.87 |         723 |           3 |
| NC    | Open            |              626 |            3.56 |             24.0 |         715 |           3 |
| PA    | Open            |              463 |            3.76 |            25.27 |         436 |           3 |
| QC    | Open            |              396 |            3.67 |            25.02 |        1757 |           3 |
| WI    | Open            |              224 |            3.73 |            26.46 |         350 |           3 |
| EDH   | Open            |              186 |            3.82 |            11.78 |         114 |           3 |
+-------+-----------------+------------------+-----------------+------------------+-------------+-------------+
	
3. For this last part of your analysis, you are going to choose the type of analysis you want to conduct on the Yelp dataset and are going to prepare the data for analysis.

Ideas for analysis include: Parsing out keywords and business attributes for sentiment analysis, clustering businesses to find commonalities or anomalies between them, predicting the overall star rating for a business, predicting the number of fans a user will have, and so on. These are just a few examples to get you started, so feel free to be creative and come up with your own problem you want to solve. Provide answers, in-line, to all of the following:
	
i. Indicate the type of analysis you chose to do:
         
		-- What are some determining factors to whether a business is still OPEN or CLOSED?

ii. Write 1-2 brief paragraphs on the type of data you will need for your analysis and why you chose that data:
                           
		-- I will use the business table to get information such as location, review_count, and stars to compare and contrast and try to find any identifiable factors that contribute to both the success and the detriment of businesses using filters to compare the differences in open businesses based on stars & review_count.  
		-- I will begin by identifying what business are CLOSED.  Then, I will compare the number of review_counts to stars to compare the total number count of business based on changing the parameters. 
		-- I will use a base number of 4 for stars, to select higher rated businesses to see whether star count (despite high count) is a higher, or lower determinant of business closure, compare to review_count)

iii. Output of your finished dataset:
         
-- I wanted to start by finding how many businesses closed then they had a high star rating (>4) and a minimum review_count of over 100.  It returned a total of: 10

-- It seems REVIEW COUNT has the highest effect on whether a company goes out of business more so than the rating.  

-- I imagine this is because 5 reviews with high star rating doesn't create as much credibility in a business as opposed to many reviews, despite lower star rating.  Hence, more opinions allows for a clearer picture of the up and downsides.

-- It's clear when you compare the tables that anytime the reviews < 100, the number of businesses closed increases significantly.  If we change star rating, it does affect the number, but in less dramatic manner.  They both seem to correlate with one another, but it makes sense that with more reviews equals more objective and accurate information.

+----------------------+--------+
| Number_of_Businesses | status |
+----------------------+--------+
|                   10 | CLOSED |
+----------------------+--------+

-- I then changed the numer of review_count to <100 and start > 4 it returned a total of: 317

+----------------------+--------+
| Number_of_Businesses | status |
+----------------------+--------+
|                  317 | CLOSED |
+----------------------+--------+

-- I then changed the number of review_count back to >100 and changed the number of stars to <4, it returned: 33

+----------------------+--------+
| Number_of_Businesses | status |
+----------------------+--------+
|                   33 | CLOSED |
+----------------------+--------+

-- I fiinally changed review_count to <100 and kept stars to <4, it returned: 834

+----------------------+--------+
| Number_of_Businesses | status |
+----------------------+--------+
|                  834 | CLOSED |
+----------------------+--------+
         
iv. Provide the SQL code you used to create your final dataset:

SELECT
    COUNT(id) AS Number_of_Businesses,
    CASE WHEN is_open = '1' THEN 'OPEN'
    ELSE 'CLOSED' END AS status
FROM
    business
WHERE
    review_count >100 AND
    stars > 4.0 AND
    status = 'CLOSED'
ORDER BY 
	review_count, stars

-- TOTAL BUSINESSES CLOSED: 10 (LOWEST CHANCE OF CLOSING)

SELECT
    COUNT(id) AS Number_of_Businesses,
    CASE WHEN is_open = '1' THEN 'OPEN'
    ELSE 'CLOSED' END AS status
FROM
    business
WHERE
    review_count < 100 AND
    stars > 4.0 AND
    status = 'CLOSED'
ORDER BY 
	review_count, stars

-- TOTAL BUSINESSES CLOSED: 317 (HIGHER CHANCE OF CLOSING WITH LOWER REVIEW COUNTS & HIGH STAR RATING)

SELECT
    COUNT(id) AS Number_of_Businesses,
    CASE WHEN is_open = '1' THEN 'OPEN'
    ELSE 'CLOSED' END AS status
FROM
    business
WHERE
    review_count > 100 AND
    stars < 4.0 AND
    status = 'CLOSED'
ORDER BY 
	review_count, stars

-- TOTAL BUSINESSES CLOSED: 33 (LOWER CHANCE OF CLOSING WITH HIGHER REVIEWS & LESS STAR RATING)

SELECT
    COUNT(id) AS Number_of_Businesses,
    CASE WHEN is_open = '1' THEN 'OPEN'
    ELSE 'CLOSED' END AS status
FROM
    business
WHERE
    review_count < 100 AND
    stars < 4.0 AND
    status = 'CLOSED'
ORDER BY r
	eview_count, stars

-- TOTAL BUSINESSES CLOSED: 834 (HIGHEST CHANCE OF CLOSING)
